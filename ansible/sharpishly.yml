---
- name: Provision SharpishlyApp environment
  hosts: localhost
  become: true

  tasks:
    - name: Ensure base packages
      package:
        name:
          - openssl
          - ufw
        state: present

    - name: Include Docker setup
      import_tasks: docker.yml

    - name: Include SSL setup
      import_tasks: ssl.yml

    - name: Include Nginx setup
      import_tasks: nginx.yml

    - name: Configure firewall
      ufw:
        rule: allow
        port: "{{ item }}"
      loop:
        - "80"
        - "443"

    - name: Reload firewall
      command: ufw reload

    - name: Add hostname entries
      lineinfile:
        path: /etc/
